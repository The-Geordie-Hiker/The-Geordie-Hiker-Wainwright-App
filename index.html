<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wainwright Guide</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; margin: 0; }
        h1, h2 { color: #333; }
        .filters { margin: 20px 0; }
        .filters select { padding: 8px; margin: 5px 10px 5px 0; border-radius: 5px; font-size: 14px; }
        .button-container { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 20px; }
        .button { padding: 10px 20px; background-color: #007BFF; color: white; border: none; border-radius: 5px; font-size: 14px; cursor: pointer; flex: 1 1 calc(20% - 10px); text-align: center; }
        .button:hover { background-color: #0056b3; }
        .wainwright-info { background-color: white; border-radius: 5px; padding: 20px; margin-top: 20px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        .wainwright-info h3 { font-size: 24px; margin-bottom: 10px; color: #007BFF; }
        .wainwright-info p { font-size: 16px; line-height: 1.6; margin: 5px 0; }
        .wainwright-info a { color: #007BFF; text-decoration: none; }
        .wainwright-info a:hover { text-decoration: underline; }
        .tab-container { margin-bottom: 20px; }
        .tab-button { padding: 10px 20px; background-color: #ddd; border: none; cursor: pointer; font-size: 16px; }
        .tab-button.active { background-color: #007BFF; color: white; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        #tracker { padding-top: 40px; }
        #tracker #progress-bar { position: fixed; top: 0; left: 0; width: 100%; height: 20px; display: flex; z-index: 1000; }
        #tracker #completed { height: 100%; background-color: green; transition: width 0.3s ease; }
        #tracker #remaining { height: 100%; background-color: red; flex-grow: 1; }
        #tracker #progress-text { position: absolute; width: 100%; height: 100%; text-align: center; color: white; font-weight: bold; line-height: 20px; text-shadow: 1px 1px 2px black; pointer-events: none; }
        #tracker #container { display: flex; gap: 20px; max-width: 1200px; margin: 0 auto; }
        #tracker #map { height: 500px; width: 70%; border: 1px solid #ccc; }
        #tracker #list { width: 30%; background: white; padding: 10px; border-radius: 5px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); overflow-y: auto; max-height: 500px; }
        #tracker #wainwright-list-tracker { list-style: none; padding: 0; }
        #tracker #wainwright-list-tracker li { padding: 5px 0; }
        #tracker .completed { color: green; font-weight: bold; }
    </style>
</head>
<body>
    <h1>Wainwright Guide</h1>
    <div class="tab-container">
        <button class="tab-button active" onclick="openTab('top10')">Top 10 Most Popular Wainwrights</button>
        <button class="tab-button" onclick="openTab('info')">Wainwright Info</button>
        <button class="tab-button" onclick="openTab('tracker')">Wainwright Tracker</button>
    </div>

    <div id="top10" class="tab-content active">
        <h2>Top 10 Most Popular Wainwrights</h2>
        <div id="top-wainwrights" class="button-container"></div>
    </div>

    <div id="info" class="tab-content">
        <h2>Wainwright Info</h2>
        <div class="filters">
            <select id="region-filter">
                <option value="">Select Region</option>
                <option value="Northern Fells">Northern Fells</option>
                <option value="Central Fells">Central Fells</option>
                <option value="Southern Fells">Southern Fells</option>
                <option value="Western Fells">Western Fells</option>
                <option value="Eastern Fells">Eastern Fells</option>
                <option value="Far Eastern Fells">Far Eastern Fells</option>
                <option value="North Western Fells">North Western Fells</option>
            </select>
            <select id="difficulty-filter">
                <option value="">Select Difficulty</option>
                <option value="Easy">Easy</option>
                <option value="Moderate">Moderate</option>
                <option value="Hard">Hard</option>
            </select>
            <select id="scramble-filter">
                <option value="">Scramble Involved?</option>
                <option value="Yes">Yes</option>
                <option value="No">No</option>
            </select>
            <select id="dog-filter">
                <option value="">Dog Friendly?</option>
                <option value="Yes">Yes</option>
                <option value="No">No</option>
            </select>
            <select id="length-filter">
                <option value="">Select Hike Length</option>
                <option value="Short">Short (0-4 miles)</option>
                <option value="Medium">Medium (4-7 miles)</option>
                <option value="Long">Long (7+ miles)</option>
            </select>
            <button class="button" onclick="applyFilters()">Apply Filters</button>
        </div>
        <div id="wainwright-list" class="button-container"></div>
        <div id="info-container"></div>
    </div>

    <div id="tracker" class="tab-content">
        <div id="progress-bar">
            <div id="completed"></div>
            <div id="remaining"></div>
            <div id="progress-text"></div>
        </div>
        <h1>The Geordie Hiker Wainwright Tracker</h1>
        <p style="text-align: center; font-size: 0.9em; color: #666;">Progress saves locallyâ€”use the same device and browser!</p>
        <div id="container">
            <div id="map"></div>
            <div id="list">
                <h2>Wainwrights</h2>
                <ul id="wainwright-list-tracker"></ul>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        const allWainwrights = [
            { name: "Allen Crags", lat: 54.467, lon: -3.200, completed: false, height: "785m", hikeLength: 6, gpxLink: "", osMapLink: "", mountainForecast: "", carpark: "Seathwaite", postcode: "CA12 5XJ", what3words: "///example", funFacts: "Offers views of Scafell Pike.", additionalInfo: "A quieter fell near Great Gable.", instagramReel: "", time: 3.0, weather: "", region: "Southern Fells", difficulty: "Moderate", scramble: "No", dogFriendly: "Yes" },
            { name: "Angletarn Pikes", lat: 54.527, lon: -2.907, completed: false, height: "567m", hikeLength: 4, gpxLink: "", osMapLink: "", mountainForecast: "", carpark: "Hartsop", postcode: "CA11 0NZ", what3words: "///example", funFacts: "Named after nearby Angle Tarn.", additionalInfo: "A scenic walk with two summits.", instagramReel: "", time: 2.0, weather: "", region: "Far Eastern Fells", difficulty: "Moderate", scramble: "No", dogFriendly: "Yes" },
            { name: "Ard Crags", lat: 54.618, lon: -3.262, completed: false, height: "581m", hikeLength: 5, gpxLink: "", osMapLink: "", mountainForecast: "", carpark: "Newlands Hause", postcode: "CA12 5TS", what3words: "///example", funFacts: "Part of the Newlands Valley ridge.", additionalInfo: "Great views over Buttermere.", instagramReel: "", time: 2.5, weather: "", region: "North Western Fells", difficulty: "Moderate", scramble: "Yes", dogFriendly: "Yes" },
            // Full 214 entries - restoring top 10 and Haystacks fully, others as placeholders
            { name: "Scafell Pike", region: "Southern Fells", difficulty: "Hard", scramble: "Yes", dogFriendly: "No", weather: "", height: "978m", hikeLength: 9, lat: 54.454, lon: -3.211, gpxLink: "https://www.walklakes.co.uk/gpx/Scafell_Pike.gpx", osMapLink: "https://osmaps.ordnancesurvey.co.uk/54.454,-3.211", mountainForecast: "https://www.mountain-forecast.com/peaks/Scafell-Pike/forecasts/978", carpark: "Wasdale Head Car Park", postcode: "CA20 1EX", what3words: "///rocks.cliff.path", funFacts: "England's highest mountain with panoramic views.", additionalInfo: "A challenging ascent to the highest peak in England.", instagramReel: "https://www.instagram.com/reel/scafell_pike", time: 4.5, completed: false },
            { name: "Helvellyn", region: "Eastern Fells", difficulty: "Hard", scramble: "Yes", dogFriendly: "No", weather: "", height: "950m", hikeLength: 8.5, lat: 54.527, lon: -3.016, gpxLink: "https://www.walklakes.co.uk/gpx/Helvellyn.gpx", osMapLink: "https://osmaps.ordnancesurvey.co.uk/54.527,-3.016", mountainForecast: "https://www.mountain-forecast.com/peaks/Helvellyn/forecasts/950", carpark: "Glenridding Car Park", postcode: "CA11 0PA", what3words: "///mountain.cairn.ridge", funFacts: "Third-highest peak in the Lake District.", additionalInfo: "Accessible via Striding Edge.", instagramReel: "https://www.instagram.com/reel/helvellyn", time: 4.75, completed: false },
            { name: "Skiddaw", region: "Northern Fells", difficulty: "Moderate", scramble: "No", dogFriendly: "Yes", weather: "", height: "931m", hikeLength: 6.2, lat: 54.647, lon: -3.136, gpxLink: "https://www.walklakes.co.uk/gpx/Skiddaw.gpx", osMapLink: "https://osmaps.ordnancesurvey.co.uk/54.647,-3.146", mountainForecast: "https://www.mountain-forecast.com/peaks/Skiddaw/forecasts/931", carpark: "Latrigg Car Park", postcode: "CA12 4PH", what3words: "///summit.trek.easy", funFacts: "One of the easiest high fells.", additionalInfo: "Straightforward climb from Keswick.", instagramReel: "https://www.instagram.com/reel/skiddaw", time: 3.0, completed: false },
            { name: "Great Gable", region: "Western Fells", difficulty: "Moderate", scramble: "Yes", dogFriendly: "Yes", weather: "", height: "899m", hikeLength: 5.8, lat: 54.482, lon: -3.219, gpxLink: "https://www.walklakes.co.uk/gpx/Great_Gable.gpx", osMapLink: "https://osmaps.ordnancesurvey.co.uk/54.482,-3.219", mountainForecast: "https://www.mountain-forecast.com/peaks/Great-Gable/forecasts/899", carpark: "Seathwaite Car Park", postcode: "CA12 5XQ", what3words: "///wet.muddy.trail", funFacts: "Iconic peak with dramatic shape.", additionalInfo: "Dedicated to WWI fallen soldiers.", instagramReel: "https://www.instagram.com/reel/great_gable", time: 3.0, completed: false },
            { name: "Blencathra", region: "Northern Fells", difficulty: "Hard", scramble: "Yes", dogFriendly: "No", weather: "", height: "868m", hikeLength: 7.5, lat: 54.640, lon: -3.050, gpxLink: "https://www.walklakes.co.uk/gpx/Blencathra.gpx", osMapLink: "https://osmaps.ordnancesurvey.co.uk/54.640,-3.050", mountainForecast: "https://www.mountain-forecast.com/peaks/Blencathra/forecasts/868", carpark: "Scales Fell Car Park", postcode: "CA12 4TL", what3words: "///sharp.steep.path", funFacts: "Known for rugged ridges.", additionalInfo: "Features Sharp Edge scramble.", instagramReel: "https://www.instagram.com/reel/blencathra", time: 4.5, completed: false },
            { name: "Catbells", region: "Central Fells", difficulty: "Easy", scramble: "No", dogFriendly: "Yes", weather: "", height: "451m", hikeLength: 3.5, lat: 54.568, lon: -3.170, gpxLink: "https://www.walklakes.co.uk/gpx/Catbells.gpx", osMapLink: "https://osmaps.ordnancesurvey.co.uk/54.568,-3.170", mountainForecast: "https://www.mountain-forecast.com/peaks/Catbells/forecasts/451", carpark: "Catbells Car Park", postcode: "CA12 5XP", what3words: "///easy.walk.summit", funFacts: "Perfect for beginners.", additionalInfo: "Great family hike with views.", instagramReel: "https://www.instagram.com/reel/catbells", time: 1.75, completed: false },
            { name: "Bowfell", region: "Southern Fells", difficulty: "Hard", scramble: "Yes", dogFriendly: "No", weather: "", height: "902m", hikeLength: 6.5, lat: 54.448, lon: -3.126, gpxLink: "https://www.walklakes.co.uk/gpx/Bowfell.gpx", osMapLink: "https://osmaps.ordnancesurvey.co.uk/54.448,-3.126", mountainForecast: "https://www.mountain-forecast.com/peaks/Bowfell/forecasts/902", carpark: "Old Dungeon Ghyll", postcode: "LA22 9JY", what3words: "///fell.rocks.view", funFacts: "Stunning Langdale views.", additionalInfo: "Classic Southern Fells hike.", instagramReel: "https://www.instagram.com/reel/bowfell", time: 4.0, completed: false },
            { name: "Haystacks", lat: 54.508, lon: -3.248, completed: false, height: "597m", hikeLength: 5, region: "Western Fells", difficulty: "Moderate", scramble: "Yes", dogFriendly: "Yes", gpxLink: "https://www.walklakes.co.uk/gpx/Haystacks.gpx", osMapLink: "https://osmaps.ordnancesurvey.co.uk/54.507,-3.247", mountainForecast: "https://www.mountain-forecast.com/peaks/Haystacks/forecasts/597", carpark: "Gatesgarth Car Park", postcode: "CA13 9XA", what3words: "///tarns.water.peace", funFacts: "Haystacks was Wainwright's favorite fell, with stunning tarns.", additionalInfo: "Features beautiful tarns and a rugged summit.", instagramReel: "https://www.instagram.com/reel/haystacks", time: 2.5, weather: "" },
            { name: "Langdale Pikes", region: "Central Fells", difficulty: "Moderate", scramble: "Yes", dogFriendly: "Yes", weather: "", height: "736m", hikeLength: 6, lat: 54.456, lon: -3.097, gpxLink: "https://www.walklakes.co.uk/gpx/Langdale_Pikes.gpx", osMapLink: "https://osmaps.ordnancesurvey.co.uk/54.456,-3.097", mountainForecast: "https://www.mountain-forecast.com/peaks/Harrison-Stickle/forecasts/736", carpark: "New Dungeon Ghyll", postcode: "LA22 9JX", what3words: "///pikes.walk.lang", funFacts: "Dramatic profiles visible afar.", additionalInfo: "Moderate hike with scrambles.", instagramReel: "https://www.instagram.com/reel/langdale_pikes", time: 3.25, completed: false },
            { name: "Coniston Old Man", region: "Southern Fells", difficulty: "Moderate", scramble: "No", dogFriendly: "Yes", weather: "", height: "803m", hikeLength: 6.5, lat: 54.370, lon: -3.118, gpxLink: "https://www.walklakes.co.uk/gpx/Coniston_Old_Man.gpx", osMapLink: "https://osmaps.ordnancesurvey.co.uk/54.370,-3.118", mountainForecast: "https://www.mountain-forecast.com/peaks/Coniston-Old-Man/forecasts/803", carpark: "Coniston Car Park", postcode: "LA21 8ED", what3words: "///old.man.hike", funFacts: "Classic fell with mining history.", additionalInfo: "Popular steady climb.", instagramReel: "https://www.instagram.com/reel/coniston_old_man", time: 3.25, completed: false },
            { name: "Yoke", lat: 54.456, lon: -2.861, completed: false, height: "706m", hikeLength: 7, gpxLink: "", osMapLink: "", mountainForecast: "", carpark: "", postcode: "", what3words: "", funFacts: "", additionalInfo: "", instagramReel: "", time: 3.5, weather: "", region: "Far Eastern Fells", difficulty: "Hard", scramble: "No", dogFriendly: "No" }
            // Add remaining 203 Wainwrights with full data as needed
        ];

        const topWainwrights = allWainwrights.filter(w => ["Scafell Pike", "Helvellyn", "Skiddaw", "Great Gable", "Blencathra", "Catbells", "Bowfell", "Haystacks", "Langdale Pikes", "Coniston Old Man"].includes(w.name));

        async function fetchWeather(lat, lon) {
            try {
                const response = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}Â¤t_weather=true&hourly=cloudcover`);
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                const data = await response.json();
                const weatherCode = data.current_weather.weathercode;
                const cloudCover = data.hourly.cloudcover[0];

                const weatherMap = {
                    0: "Clear", 1: "Sunny", 2: "Partly Cloudy", 3: "Cloudy",
                    45: "Foggy", 51: "Rainy", 61: "Rainy", 71: "Snowy", 95: "Stormy"
                };
                const weather = weatherMap[weatherCode] || "Unknown";
                const sunsetProbability = Math.round(Math.min(Math.max((cloudCover - 30) / 40, 0), 1) * 100);

                return { weather, sunsetProbability };
            } catch (error) {
                console.error(`Error fetching weather for lat:${lat}, lon:${lon}:`, error);
                return { weather: "Unknown", sunsetProbability: 0 };
            }
        }

        async function updateWeather() {
            const weatherPromises = allWainwrights.map(async (wainwright) => {
                const result = await fetchWeather(wainwright.lat, wainwright.lon);
                wainwright.weather = result.weather;
                wainwright.sunsetProbability = result.sunsetProbability;
            });
            await Promise.all(weatherPromises);
        }

        function displayTopWainwrights() {
            const topWainwrightsDiv = document.getElementById("top-wainwrights");
            topWainwrightsDiv.innerHTML = "";
            const buttons = topWainwrights.map(wainwright => {
                const button = document.createElement("button");
                button.className = "button";
                button.textContent = `${wainwright.name} (${wainwright.weather || 'Loading...'}, ${wainwright.sunsetProbability || 0}%)`;
                button.onclick = () => { showInfo(wainwright); openTab('info'); };
                return button;
            });
            topWainwrightsDiv.append(...buttons);
        }

        function displayWainwrights(filtered = allWainwrights) {
            const wainwrightListDiv = document.getElementById("wainwright-list");
            if (!wainwrightListDiv) {
                console.error("wainwright-list element not found!");
                return;
            }
            wainwrightListDiv.innerHTML = "";
            const buttons = filtered.map(wainwright => {
                const button = document.createElement("button");
                button.className = "button";
                button.textContent = `${wainwright.name} (${wainwright.weather || 'Loading...'}, ${wainwright.sunsetProbability || 0}%)`;
                button.onclick = () => showInfo(wainwright);
                return button;
            });
            wainwrightListDiv.append(...buttons);
        }

        function applyFilters() {
            const region = document.getElementById("region-filter").value;
            const difficulty = document.getElementById("difficulty-filter").value;
            const scramble = document.getElementById("scramble-filter").value;
            const dogFriendly = document.getElementById("dog-filter").value;
            const length = document.getElementById("length-filter").value;
            let filtered = [...allWainwrights];
            if (region) filtered = filtered.filter(w => w.region === region);
            if (difficulty) filtered = filtered.filter(w => w.difficulty === difficulty);
            if (scramble) filtered = filtered.filter(w => w.scramble === scramble);
            if (dogFriendly) filtered = filtered.filter(w => w.dogFriendly === dogFriendly);
            if (length) {
                filtered = filtered.filter(w => {
                    if (length === "Short") return w.hikeLength <= 4;
                    if (length === "Medium") return w.hikeLength > 4 && w.hikeLength <= 7;
                    if (length === "Long") return w.hikeLength > 7;
                    return true;
                });
            }
            displayWainwrights(filtered);
        }

        function showInfo(wainwright) {
            const infoDiv = document.getElementById("info-container");
            if (!infoDiv) {
                console.error("info-container element not found!");
                return;
            }
            infoDiv.innerHTML = `
                <div class="wainwright-info">
                    <h3>${wainwright.name}</h3>
                    <p><strong>Region:</strong> ${wainwright.region || 'N/A'}</p>
                    <p><strong>Difficulty:</strong> ${wainwright.difficulty || 'N/A'}</p>
                    <p><strong>Scramble:</strong> ${wainwright.scramble || 'N/A'}</p>
                    <p><strong>Dog Friendly:</strong> ${wainwright.dogFriendly || 'N/A'}</p>
                    <p><strong>Weather:</strong> ${wainwright.weather || 'Loading...'}</p>
                    <p><strong>Sunset Probability:</strong> ${wainwright.sunsetProbability || 0}%</p>
                    <p><strong>Height:</strong> ${wainwright.height || 'N/A'}</p>
                    <p><strong>Hike Length:</strong> ${wainwright.hikeLength ? wainwright.hikeLength + ' miles' : 'N/A'}</p>
                    <p><strong>Estimated Time:</strong> ${wainwright.time ? wainwright.time + ' hours' : 'N/A'}</p>
                    <p><strong>GPX Route:</strong> ${wainwright.gpxLink ? '<a href="' + wainwright.gpxLink + '" target="_blank">Download</a>' : 'N/A'}</p>
                    <p><strong>OS Map:</strong> ${wainwright.osMapLink ? '<a href="' + wainwright.osMapLink + '" target="_blank">View</a>' : 'N/A'}</p>
                    <p><strong>Mountain Forecast:</strong> ${wainwright.mountainForecast ? '<a href="' + wainwright.mountainForecast + '" target="_blank">Check</a>' : 'N/A'}</p>
                    <p><strong>Car Park:</strong> ${wainwright.carpark ? wainwright.carpark + ' (' + wainwright.postcode + ')' : 'N/A'}</p>
                    <p><strong>What3Words:</strong> ${wainwright.what3words || 'N/A'}</p>
                    <p><strong>Fun Fact:</strong> ${wainwright.funFacts || 'N/A'}</p>
                    <p><strong>Additional Info:</strong> ${wainwright.additionalInfo || 'N/A'}</p>
                    <p><strong>Instagram Reel:</strong> ${wainwright.instagramReel ? '<a href="' + wainwright.instagramReel + '" target="_blank">Watch</a>' : 'N/A'}</p>
                </div>
            `;
        }

        const map = L.map("map").setView([54.5, -3.2], 10);
        L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
            attribution: "Â© OpenStreetMap contributors"
        }).addTo(map);

        const markers = {};

        function loadProgress() {
            console.log("Loading progress...");
            const saved = localStorage.getItem("wainwrightProgress");
            if (saved) {
                try {
                    const progress = JSON.parse(saved);
                    allWainwrights.forEach((w, i) => w.completed = progress[i].completed);
                    console.log("Progress loaded successfully");
                } catch (error) {
                    console.error("Error loading progress:", error);
                }
            }
        }

        function saveProgress() {
            console.log("Saving progress...");
            localStorage.setItem("wainwrightProgress", JSON.stringify(allWainwrights));
        }

        function updateProgressBar() {
            const total = allWainwrights.length;
            const completedCount = allWainwrights.filter(w => w.completed).length;
            const completedPercentage = (completedCount / total) * 100;
            document.getElementById("completed").style.width = `${completedPercentage}%`;
            document.getElementById("progress-text").textContent = `${completedCount}/${total} - ${completedPercentage.toFixed(1)}%`;
        }

        function updateTrackerDisplay() {
            console.log("Starting updateTrackerDisplay, Wainwrights count:", allWainwrights.length);
            const list = document.getElementById("wainwright-list-tracker");
            if (!list) {
                console.error("Tracker list element not found!");
                return;
            }
            list.innerHTML = "";

            allWainwrights.forEach((wainwright, index) => {
                console.log(`Processing ${index + 1}/${allWainwrights.length}: ${wainwright.name}`);
                try {
                    const li = document.createElement("li");
                    const checkbox = document.createElement("input");
                    checkbox.type = "checkbox";
                    checkbox.checked = wainwright.completed;
                    checkbox.addEventListener("change", () => {
                        wainwright.completed = checkbox.checked;
                        updateMarker(wainwright);
                        saveProgress();
                        updateProgressBar();
                    });
                    li.appendChild(checkbox);
                    const nameLink = document.createElement("a");
                    nameLink.textContent = ` ${wainwright.name}`;
                    nameLink.href = "#";
                    nameLink.onclick = () => { showInfo(wainwright); openTab('info'); return false; };
                    li.appendChild(nameLink);
                    if (wainwright.completed) li.classList.add("completed");
                    list.appendChild(li);

                    if (markers[wainwright.name]) map.removeLayer(markers[wainwright.name]);
                    markers[wainwright.name] = L.circleMarker([wainwright.lat, wainwright.lon], {
                        radius: 5,
                        color: wainwright.completed ? "green" : "red",
                        fillOpacity: 0.8
                    }).addTo(map).bindPopup(wainwright.name).on('click', () => { showInfo(wainwright); openTab('info'); });
                } catch (error) {
                    console.error(`Error processing ${wainwright.name}:`, error);
                }
            });
            updateProgressBar();
            console.log("updateTrackerDisplay completed");
        }

        function updateMarker(wainwright) {
            if (markers[wainwright.name]) {
                markers[wainwright.name].setStyle({
                    color: wainwright.completed ? "green" : "red"
                });
            }
        }

        function openTab(tabName) {
            const tabs = document.getElementsByClassName("tab-content");
            for (let i = 0; i < tabs.length; i++) tabs[i].classList.remove("active");
            const buttons = document.getElementsByClassName("tab-button");
            for (let i = 0; i < buttons.length; i++) buttons[i].classList.remove("active");
            document.getElementById(tabName).classList.add("active");
            document.querySelector(`button[onclick="openTab('${tabName}')"]`).classList.add("active");
            if (tabName === 'tracker') map.invalidateSize();
            if (tabName === 'info') displayWainwrights();
        }

        async function init() {
            loadProgress();
            displayTopWainwrights();
            displayWainwrights();
            updateTrackerDisplay();
            await updateWeather();
            displayTopWainwrights();
            displayWainwrights();
            updateTrackerDisplay();
        }

        init();
    </script>
</body>
</html>
